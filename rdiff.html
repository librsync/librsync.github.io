<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<title>librsync: rdiff</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <!-- ad -->
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- librsync -->
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-3547096055927362"
         data-ad-slot="8322976738"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">librsync
   &#160;<span id="projectnumber">2.3.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">rdiff </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md60"></a>
Introduction</h1>
<p><em>rdiff</em> is a program to compute and apply network deltas. An <em>rdiff delta</em> is a delta between binary files, describing how a <em>basis</em> (or <em>old</em>) file can be automatically edited to produce a <em>result</em> (or <em>new</em>) file.</p>
<p>Unlike most diff programs, librsync does not require access to both of the files when the diff is computed. Computing a delta requires just a short "signature" of the old file and the complete contents of the new file. The signature contains checksums for blocks of the old file. Using these checksums, rdiff finds matching blocks in the new file, and then computes the delta.</p>
<p>rdiff deltas are usually less compact and also slower to produce than xdeltas or regular text diffs. If it is possible to have both the old and new files present when computing the delta, <a href="http://www.xcf.berkeley.edu/~jmacd/xdelta.html">xdelta</a> will generally produce a much smaller file. If the files being compared are plain text, then GNU <a href="http://www.gnu.org/software/diffutils/diffutils.html">diff</a> is usually a better choice, as the diffs can be viewed by humans and applied as inexact matches.</p>
<p>rdiff comes into its own when it is not convenient to have both files present at the same time. One example of this is that the two files are on separate machines, and you want to transfer only the differences. Another example is when one of the files has been moved to archive or backup media, leaving only its signature.</p>
<p>Symbolically</p>
<blockquote class="doxtable">
<p>signature(<em>basis-file</em>) -&gt; <em>sig-file</em></p>
<p>delta(<em>sig-file</em>, <em>new-file</em>) -&gt; <em>delta-file</em></p>
<p>patch(<em>basis-file</em>, <em>delta-file</em>) -&gt; <em>recreated-file</em> </p>
</blockquote>
<p>rdiff signatures and deltas are binary files in a format specific to rdiff. Signatures consist of a header, followed by a list of checksums for successive fixed-size blocks. Deltas consist of a header followed by an instruction stream, which when executed produces the output file. There are instructions to insert new data specified in the patch, or to copy data from the basis file.</p>
<p>Unlike regular text diffs, rdiff deltas can describe sections of the input file which have been reordered or copied.</p>
<p>Because block checksums are used to find identical sections, rdiff cannot find common sections smaller than one block, and it may not exactly identify common sections near changed sections. Changes that touch every block of the file, such as changing newlines to CRLF, are likely to cause no blocks to match at all.</p>
<p>rdiff does not deal with file metadata or structure, such as filenames, permissions, or directories. To rdiff, a file is just a stream of bytes. Higher-level tools, such as <a href="http://rdiff-backup.stanford.edu/">rdiff-backup</a> can deal with these issues in a way appropriate to their users.</p>
<h1><a class="anchor" id="autotoc_md61"></a>
Use patterns</h1>
<p>A typical application of the rsync algorithm is to transfer a file <em>A2</em> from a machine A to a machine B which has a similar file <em>A1</em>. This can be done as follows:</p>
<ol type="1">
<li>B generates the rdiff signature of <em>A1</em>. Call this <em>S1</em>. B sends the signature to A. (The signature is usually much smaller than the file it describes.)</li>
<li>A computes the rdiff delta between <em>S1</em> and <em>A2</em>. Call this delta <em>D</em>. A sends the delta to B.</li>
<li>B applies the delta to recreate <em>A2</em>.</li>
</ol>
<p>In cases where <em>A1</em> and <em>A2</em> contain runs of identical bytes, rdiff should give a significant space saving.</p>
<h1><a class="anchor" id="autotoc_md62"></a>
Invoking rdiff</h1>
<p>There are three distinct modes of operation: <em>signature</em>, <em>delta</em> and <em>patch</em>. The mode is selected by the first command argument.</p>
<h2><a class="anchor" id="autotoc_md63"></a>
signature</h2>
<blockquote class="doxtable">
<p>rdiff [OPTIONS] signature INPUT SIGNATURE </p>
</blockquote>
<p><b>rdiff signature</b> generates a signature file from an input file. The signature can later be used to generate a delta relative to the old file.</p>
<h2><a class="anchor" id="autotoc_md64"></a>
delta</h2>
<blockquote class="doxtable">
<p>rdiff [OPTIONS] delta SIGNATURE NEWFILE DELTA </p>
</blockquote>
<p><b>rdiff delta</b> reads in a delta describing a basis file. It then calculates and writes a delta delta that transforms the basis into the new file.</p>
<h2><a class="anchor" id="autotoc_md65"></a>
patch</h2>
<blockquote class="doxtable">
<p>rdiff [OPTIONS] patch BASIS DELTA OUTPUT </p>
</blockquote>
<p>rdiff applies a delta to a basis file and writes out the result.</p>
<p>rdiff cannot update files in place: the output file must not be the same as the input file.</p>
<p>rdiff does not currently check that the delta is being applied to the correct file. If a delta is applied to the wrong basis file, the results will be garbage.</p>
<p>The basis file must allow random access. This means it must be a regular file rather than a pipe or socket.</p>
<h2><a class="anchor" id="autotoc_md66"></a>
Global Options</h2>
<p>These options are available for all commands.</p>
<p><code>--version</code> Show program version and copyright.</p>
<p><code>--help</code> Show brief help message.</p>
<p><code>--statistics</code> Show counts of internal operations.</p>
<p><code>--debug</code> Write debugging information to stderr.</p>
<p>Options must be specified before the command name.</p>
<h1><a class="anchor" id="autotoc_md67"></a>
Return Value</h1>
<p>0: Successful completion.</p>
<p>1: Environmental problems (file not found, invalid options, IO error, etc).</p>
<p>2: Corrupt signature or delta file.</p>
<p>3: Internal error or unhandled situation in librsync or rdiff.</p>
<h1><a class="anchor" id="autotoc_md68"></a>
Bugs</h1>
<p>Unlike text patches, rdiff deltas can only be usefully applied to the exact basis file that they were generated from. rdiff does not protect against trying to apply a delta to the wrong file, though this will produce garbage output. It may be useful to store a hash of the file to which the digest is meant to be applied.</p>
<h1><a class="anchor" id="autotoc_md69"></a>
Author</h1>
<p>rdiff was written by Martin Pool. The original rsync algorithm was discovered by Andrew Tridgell.</p>
<p>This program is part of the <a href="http://librsync.sourcefrog.net/">librsync</a> package. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<!-- ad -->
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- librsync -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3547096055927362"
     data-ad-slot="8322976738"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<!-- analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-71109100-1', 'auto');
  ga('send', 'pageview');
</script>
<hr class="footer"/><address class="footer"><small>
Generated on Tue May 12 2020 15:46:02 for librsync by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
