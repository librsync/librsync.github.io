<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<title>librsync: delta.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <!-- ad -->
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- librsync -->
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-3547096055927362"
         data-ad-slot="8322976738"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">librsync
   &#160;<span id="projectnumber">2.3.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">delta.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Generate in streaming mode an rsync delta given a set of signatures, and a new file.  
<a href="#details">More...</a></p>

<p><a href="delta_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6a992cf5dc0916678a7094c21b85d5fe"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="librsync_8h.html#a7feb858ceba3b8f3cf048d49be108253">rs_result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="delta_8c.html#a6a992cf5dc0916678a7094c21b85d5fe">rs_delta_s_scan</a> (<a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a> *job)</td></tr>
<tr class="memdesc:a6a992cf5dc0916678a7094c21b85d5fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a block of data if possible, and see if it matches.  <a href="delta_8c.html#a6a992cf5dc0916678a7094c21b85d5fe">More...</a><br /></td></tr>
<tr class="separator:a6a992cf5dc0916678a7094c21b85d5fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55891ddb7cdcd5790b38ced140734102"><td class="memItemLeft" align="right" valign="top"><a id="a55891ddb7cdcd5790b38ced140734102"></a>
static <a class="el" href="librsync_8h.html#a7feb858ceba3b8f3cf048d49be108253">rs_result</a>&#160;</td><td class="memItemRight" valign="bottom"><b>rs_delta_s_flush</b> (<a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a> *job)</td></tr>
<tr class="separator:a55891ddb7cdcd5790b38ced140734102"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd7b048f68dab7cb6fc927802823ea4e"><td class="memItemLeft" align="right" valign="top"><a id="afd7b048f68dab7cb6fc927802823ea4e"></a>
static <a class="el" href="librsync_8h.html#a7feb858ceba3b8f3cf048d49be108253">rs_result</a>&#160;</td><td class="memItemRight" valign="bottom"><b>rs_delta_s_end</b> (<a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a> *job)</td></tr>
<tr class="separator:afd7b048f68dab7cb6fc927802823ea4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af25d76d877395b05f1bfdbef5eb61ec5"><td class="memItemLeft" align="right" valign="top"><a id="af25d76d877395b05f1bfdbef5eb61ec5"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>rs_getinput</b> (<a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a> *job)</td></tr>
<tr class="separator:af25d76d877395b05f1bfdbef5eb61ec5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02cb5f8a81c7cb63d2557023c56929e7"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="delta_8c.html#a02cb5f8a81c7cb63d2557023c56929e7">rs_findmatch</a> (<a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a> *job, rs_long_t *match_pos, size_t *match_len)</td></tr>
<tr class="memdesc:a02cb5f8a81c7cb63d2557023c56929e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">find a match at scoop_pos, returning the match_pos and match_len.  <a href="delta_8c.html#a02cb5f8a81c7cb63d2557023c56929e7">More...</a><br /></td></tr>
<tr class="separator:a02cb5f8a81c7cb63d2557023c56929e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc386d6304337b138b79b5712c15931a"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="librsync_8h.html#a7feb858ceba3b8f3cf048d49be108253">rs_result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="delta_8c.html#acc386d6304337b138b79b5712c15931a">rs_appendmatch</a> (<a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a> *job, rs_long_t match_pos, size_t match_len)</td></tr>
<tr class="memdesc:acc386d6304337b138b79b5712c15931a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Append a match at match_pos of length match_len to the delta, extending a previous match if possible, or flushing any previous miss/match.  <a href="delta_8c.html#acc386d6304337b138b79b5712c15931a">More...</a><br /></td></tr>
<tr class="separator:acc386d6304337b138b79b5712c15931a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a832b35b9afeeb51561f08daf13738571"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="librsync_8h.html#a7feb858ceba3b8f3cf048d49be108253">rs_result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="delta_8c.html#a832b35b9afeeb51561f08daf13738571">rs_appendmiss</a> (<a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a> *job, size_t miss_len)</td></tr>
<tr class="memdesc:a832b35b9afeeb51561f08daf13738571"><td class="mdescLeft">&#160;</td><td class="mdescRight">Append a miss of length miss_len to the delta, extending a previous miss if possible, or flushing any previous match.  <a href="delta_8c.html#a832b35b9afeeb51561f08daf13738571">More...</a><br /></td></tr>
<tr class="separator:a832b35b9afeeb51561f08daf13738571"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c7bfd74ede4c7fa74eeca10bb5d6679"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="librsync_8h.html#a7feb858ceba3b8f3cf048d49be108253">rs_result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="delta_8c.html#a8c7bfd74ede4c7fa74eeca10bb5d6679">rs_appendflush</a> (<a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a> *job)</td></tr>
<tr class="memdesc:a8c7bfd74ede4c7fa74eeca10bb5d6679"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flush any accumulating hit or miss, appending it to the delta.  <a href="delta_8c.html#a8c7bfd74ede4c7fa74eeca10bb5d6679">More...</a><br /></td></tr>
<tr class="separator:a8c7bfd74ede4c7fa74eeca10bb5d6679"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e40db810b7290fe6d5fd1be2656e04d"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="librsync_8h.html#a7feb858ceba3b8f3cf048d49be108253">rs_result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="delta_8c.html#a2e40db810b7290fe6d5fd1be2656e04d">rs_processmatch</a> (<a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a> *job)</td></tr>
<tr class="memdesc:a2e40db810b7290fe6d5fd1be2656e04d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process matching data in the scoop.  <a href="delta_8c.html#a2e40db810b7290fe6d5fd1be2656e04d">More...</a><br /></td></tr>
<tr class="separator:a2e40db810b7290fe6d5fd1be2656e04d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17e651660e2da438be938cfcf4f5d0b7"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="librsync_8h.html#a7feb858ceba3b8f3cf048d49be108253">rs_result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="delta_8c.html#a17e651660e2da438be938cfcf4f5d0b7">rs_processmiss</a> (<a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a> *job)</td></tr>
<tr class="memdesc:a17e651660e2da438be938cfcf4f5d0b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process miss data in the scoop.  <a href="delta_8c.html#a17e651660e2da438be938cfcf4f5d0b7">More...</a><br /></td></tr>
<tr class="separator:a17e651660e2da438be938cfcf4f5d0b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a761d7df9081cf4ab4510e1cebc7c604a"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="librsync_8h.html#a7feb858ceba3b8f3cf048d49be108253">rs_result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="delta_8c.html#a761d7df9081cf4ab4510e1cebc7c604a">rs_delta_s_slack</a> (<a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a> *job)</td></tr>
<tr class="memdesc:a761d7df9081cf4ab4510e1cebc7c604a"><td class="mdescLeft">&#160;</td><td class="mdescRight">State function that does a slack delta containing only literal data to recreate the input.  <a href="delta_8c.html#a761d7df9081cf4ab4510e1cebc7c604a">More...</a><br /></td></tr>
<tr class="separator:a761d7df9081cf4ab4510e1cebc7c604a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8df6a969396ff04b72ebff623ec4c603"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="librsync_8h.html#a7feb858ceba3b8f3cf048d49be108253">rs_result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="delta_8c.html#a8df6a969396ff04b72ebff623ec4c603">rs_delta_s_header</a> (<a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a> *job)</td></tr>
<tr class="memdesc:a8df6a969396ff04b72ebff623ec4c603"><td class="mdescLeft">&#160;</td><td class="mdescRight">State function for writing out the header of the encoding job.  <a href="delta_8c.html#a8df6a969396ff04b72ebff623ec4c603">More...</a><br /></td></tr>
<tr class="separator:a8df6a969396ff04b72ebff623ec4c603"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65478298ed5fdebb7c91970d354e9ab3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="delta_8c.html#a65478298ed5fdebb7c91970d354e9ab3">rs_delta_begin</a> (<a class="el" href="librsync_8h.html#afb2a9cb505daeb8e519d06686f5caabf">rs_signature_t</a> *sig)</td></tr>
<tr class="memdesc:a65478298ed5fdebb7c91970d354e9ab3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare to compute a streaming delta.  <a href="delta_8c.html#a65478298ed5fdebb7c91970d354e9ab3">More...</a><br /></td></tr>
<tr class="separator:a65478298ed5fdebb7c91970d354e9ab3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Generate in streaming mode an rsync delta given a set of signatures, and a new file. </p>
<p>The size of blocks for signature generation is determined by the block size in the incoming signature.</p>
<p>To calculate a signature, we need to be able to see at least one block of the new file at a time. Once we have that, we calculate its weak signature, and see if there is any block in the signature hash table that has the same weak sum. If there is one, then we also compute the strong sum of the new block, and cross check that. If they're the same, then we can assume we have a match.</p>
<p>The final block of the file has to be handled a little differently, because it may be a short match. Short blocks in the signature don't include their length &ndash; we just allow for the final short block of the file to match any block in the signature, and if they have the same checksum we assume they must have the same length. Therefore, when we emit a COPY command, we have to send it with a length that is the same as the block matched, and not the block length from the signature.</p>
<p>Profiling results as of v1.26, 2001-03-18:</p>
<p>If everything matches, then we spend almost all our time in rs_mdfour64 and rs_weak_sum, which is unavoidable and therefore a good profile.</p>
<p>If nothing matches, it is not so good.</p>
<p>2002-06-26: Donovan Baarda</p>
<p>The following is based entirely on pysync. It is much cleaner than the previous incarnation of this code. It is slightly complicated because in this case the output can block, so the main delta loop needs to stop when this happens.</p>
<p>In pysync a 'last' attribute is used to hold the last miss or match for extending if possible. In this code, basis_len and scoop_pos are used instead of 'last'. When basis_len &gt; 0, last is a match. When basis_len = 0 and scoop_pos is &gt; 0, last is a miss. When both are 0, last is None (ie, nothing).</p>
<p>Pysync is also slightly different in that a 'flush' method is available to force output of accumulated data. This 'flush' is use to finalise delta calculation. In librsync input is terminated with an eof flag on the input stream. I have structured this code similar to pysync with a seperate flush function that is used when eof is reached. This allows for a flush style API if one is ever needed. Note that flush in pysync can be used for more than just terminating delta calculation, so a flush based API can in some ways be more flexible...</p>
<p>The input data is first scanned, then processed. Scanning identifies input data as misses or matches, and emits the instruction stream. Processing the data consumes it off the input scoop and outputs the processed miss data into the tube.</p>
<p>The scoop contains all data yet to be processed. The scoop_pos is an index into the scoop that indicates the point scanned to. As data is scanned, scoop_pos is incremented. As data is processed, it is removed from the scoop and scoop_pos adjusted. Everything gets complicated because the tube can block. When the tube is blocked, no data can be processed. </p>

<p class="definition">Definition in file <a class="el" href="delta_8c_source.html">delta.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a6a992cf5dc0916678a7094c21b85d5fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a992cf5dc0916678a7094c21b85d5fe">&#9670;&nbsp;</a></span>rs_delta_s_scan()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="librsync_8h.html#a7feb858ceba3b8f3cf048d49be108253">rs_result</a> rs_delta_s_scan </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a> *&#160;</td>
          <td class="paramname"><em>job</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get a block of data if possible, and see if it matches. </p>
<p>On each call, we try to process all of the input data available on the scoop and input buffer. </p>

<p class="definition">Definition at line <a class="el" href="delta_8c_source.html#l00119">119</a> of file <a class="el" href="delta_8c_source.html">delta.c</a>.</p>

</div>
</div>
<a id="a02cb5f8a81c7cb63d2557023c56929e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02cb5f8a81c7cb63d2557023c56929e7">&#9670;&nbsp;</a></span>rs_findmatch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int rs_findmatch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a> *&#160;</td>
          <td class="paramname"><em>job</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rs_long_t *&#160;</td>
          <td class="paramname"><em>match_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>match_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>find a match at scoop_pos, returning the match_pos and match_len. </p>
<p>Note that this will calculate weak_sum if required. It will also determine the match_len.</p>
<p>This routine could be modified to do xdelta style matches that would extend matches past block boundaries by matching backwards and forwards beyond the block boundaries. Extending backwards would require decrementing scoop_pos as appropriate. </p>

<p class="definition">Definition at line <a class="el" href="delta_8c_source.html#l00222">222</a> of file <a class="el" href="delta_8c_source.html">delta.c</a>.</p>

</div>
</div>
<a id="acc386d6304337b138b79b5712c15931a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc386d6304337b138b79b5712c15931a">&#9670;&nbsp;</a></span>rs_appendmatch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="librsync_8h.html#a7feb858ceba3b8f3cf048d49be108253">rs_result</a> rs_appendmatch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a> *&#160;</td>
          <td class="paramname"><em>job</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rs_long_t&#160;</td>
          <td class="paramname"><em>match_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>match_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Append a match at match_pos of length match_len to the delta, extending a previous match if possible, or flushing any previous miss/match. </p>

<p class="definition">Definition at line <a class="el" href="delta_8c_source.html#l00251">251</a> of file <a class="el" href="delta_8c_source.html">delta.c</a>.</p>

</div>
</div>
<a id="a832b35b9afeeb51561f08daf13738571"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a832b35b9afeeb51561f08daf13738571">&#9670;&nbsp;</a></span>rs_appendmiss()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="librsync_8h.html#a7feb858ceba3b8f3cf048d49be108253">rs_result</a> rs_appendmiss </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a> *&#160;</td>
          <td class="paramname"><em>job</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>miss_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Append a miss of length miss_len to the delta, extending a previous miss if possible, or flushing any previous match. </p>
<p>This also breaks misses up into 32KB segments to avoid accumulating too much in memory. </p>

<p class="definition">Definition at line <a class="el" href="delta_8c_source.html#l00281">281</a> of file <a class="el" href="delta_8c_source.html">delta.c</a>.</p>

</div>
</div>
<a id="a8c7bfd74ede4c7fa74eeca10bb5d6679"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c7bfd74ede4c7fa74eeca10bb5d6679">&#9670;&nbsp;</a></span>rs_appendflush()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="librsync_8h.html#a7feb858ceba3b8f3cf048d49be108253">rs_result</a> rs_appendflush </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a> *&#160;</td>
          <td class="paramname"><em>job</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flush any accumulating hit or miss, appending it to the delta. </p>

<p class="definition">Definition at line <a class="el" href="delta_8c_source.html#l00296">296</a> of file <a class="el" href="delta_8c_source.html">delta.c</a>.</p>

</div>
</div>
<a id="a2e40db810b7290fe6d5fd1be2656e04d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e40db810b7290fe6d5fd1be2656e04d">&#9670;&nbsp;</a></span>rs_processmatch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="librsync_8h.html#a7feb858ceba3b8f3cf048d49be108253">rs_result</a> rs_processmatch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a> *&#160;</td>
          <td class="paramname"><em>job</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process matching data in the scoop. </p>
<p>The scoop contains match data at scoop_next of length scoop_pos. This function processes that match data, returning RS_DONE if it completes, or RS_BLOCKED if it gets blocked. After it completes scoop_pos is reset to still point at the next unscanned data.</p>
<p>This function currently just removes data from the scoop and adjusts scoop_pos appropriately. In the future this could be used for something like context compressing of miss data. Note that it also calls rs_tube_catchup to output any pending output. </p>

<p class="definition">Definition at line <a class="el" href="delta_8c_source.html#l00326">326</a> of file <a class="el" href="delta_8c_source.html">delta.c</a>.</p>

</div>
</div>
<a id="a17e651660e2da438be938cfcf4f5d0b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17e651660e2da438be938cfcf4f5d0b7">&#9670;&nbsp;</a></span>rs_processmiss()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="librsync_8h.html#a7feb858ceba3b8f3cf048d49be108253">rs_result</a> rs_processmiss </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a> *&#160;</td>
          <td class="paramname"><em>job</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process miss data in the scoop. </p>
<p>The scoop contains miss data at scoop_next of length scoop_pos. This function processes that miss data, returning RS_DONE if it completes, or RS_BLOCKED if it gets blocked. After it completes scoop_pos is reset to still point at the next unscanned data.</p>
<p>This function uses rs_tube_copy to queue copying from the scoop into output. and uses rs_tube_catchup to do the copying. This automaticly removes data from the scoop, but this can block. While rs_tube_catchup is blocked, scoop_pos does not point at legit data, so scanning can also not proceed.</p>
<p>In the future this could do compression of miss data before outputing it. </p>

<p class="definition">Definition at line <a class="el" href="delta_8c_source.html#l00347">347</a> of file <a class="el" href="delta_8c_source.html">delta.c</a>.</p>

</div>
</div>
<a id="a761d7df9081cf4ab4510e1cebc7c604a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a761d7df9081cf4ab4510e1cebc7c604a">&#9670;&nbsp;</a></span>rs_delta_s_slack()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="librsync_8h.html#a7feb858ceba3b8f3cf048d49be108253">rs_result</a> rs_delta_s_slack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a> *&#160;</td>
          <td class="paramname"><em>job</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>State function that does a slack delta containing only literal data to recreate the input. </p>

<p class="definition">Definition at line <a class="el" href="delta_8c_source.html#l00356">356</a> of file <a class="el" href="delta_8c_source.html">delta.c</a>.</p>

</div>
</div>
<a id="a8df6a969396ff04b72ebff623ec4c603"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8df6a969396ff04b72ebff623ec4c603">&#9670;&nbsp;</a></span>rs_delta_s_header()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="librsync_8h.html#a7feb858ceba3b8f3cf048d49be108253">rs_result</a> rs_delta_s_header </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a> *&#160;</td>
          <td class="paramname"><em>job</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>State function for writing out the header of the encoding job. </p>

<p class="definition">Definition at line <a class="el" href="delta_8c_source.html#l00374">374</a> of file <a class="el" href="delta_8c_source.html">delta.c</a>.</p>

</div>
</div>
<a id="a65478298ed5fdebb7c91970d354e9ab3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65478298ed5fdebb7c91970d354e9ab3">&#9670;&nbsp;</a></span>rs_delta_begin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="librsync_8h.html#add6622b38e3fa557301a190876d5ed4a">rs_job_t</a>* rs_delta_begin </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librsync_8h.html#afb2a9cb505daeb8e519d06686f5caabf">rs_signature_t</a> *&#160;</td>
          <td class="paramname"><em>sig</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepare to compute a streaming delta. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>Add a version of this that takes a <a class="el" href="librsync_8h.html#ab6abafd1db0a3947bb3c076507f4f7c2" title="A uint32 magic number, emitted in bigendian/network order at the start of librsync files.">rs_magic_number</a> controlling the delta format. </dd></dl>

<p class="definition">Definition at line <a class="el" href="delta_8c_source.html#l00386">386</a> of file <a class="el" href="delta_8c_source.html">delta.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<!-- ad -->
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- librsync -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3547096055927362"
     data-ad-slot="8322976738"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<!-- analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-71109100-1', 'auto');
  ga('send', 'pageview');
</script>
<hr class="footer"/><address class="footer"><small>
Generated on Sat Apr 10 2021 15:04:34 for librsync by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.9.1
</small></address>
</body>
</html>
